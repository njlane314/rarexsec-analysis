@startuml
top to bottom direction
skinparam {
  linetype ortho
  packageStyle rectangle
  classAttributeIconSize 0
  shadowing false
  dpi 150
  pageMargin 10
  pageWidth 8.27in
  pageHeight 11.69in
}

package app {
  interface ISampleProcessor
  class DataProcessor
  class MonteCarloProcessor
  class AnalysisRunner
}

ISampleProcessor <|-- DataProcessor
ISampleProcessor <|-- MonteCarloProcessor
AnalysisRunner --> ISampleProcessor : runs
DataProcessor --> IEventProcessor : uses
MonteCarloProcessor --> IEventProcessor : uses
AnalysisRunner --> IAnalysisPlugin : loads
AnalysisRunner --> IPlotPlugin : loads

package data {
  interface IEventProcessor
  class MuonSelectionProcessor
  class ReconstructionProcessor
  class TruthChannelProcessor
  class WeightProcessor
  class BlipProcessor
}

IEventProcessor <|-- MuonSelectionProcessor
IEventProcessor <|-- ReconstructionProcessor
IEventProcessor <|-- TruthChannelProcessor
IEventProcessor <|-- WeightProcessor
IEventProcessor <|-- BlipProcessor

package plot {
  class HistogramPlotterBase
  class StackedHistogramPlot
  class UnstackedHistogramPlot
  class OccupancyMatrixPlot
  class SelectionEfficiencyPlot
  class SystematicBreakdownPlot
  class RocCurvePlot
}

HistogramPlotterBase <|-- StackedHistogramPlot
HistogramPlotterBase <|-- UnstackedHistogramPlot
HistogramPlotterBase <|-- OccupancyMatrixPlot
HistogramPlotterBase <|-- SelectionEfficiencyPlot
HistogramPlotterBase <|-- SystematicBreakdownPlot
HistogramPlotterBase <|-- RocCurvePlot

package plug {
  interface IAnalysisPlugin
  class AnalysisPluginManager
  interface IPlotPlugin
  class PlotPluginManager
}

AnalysisPluginManager o--> IAnalysisPlugin : manages
PlotPluginManager o--> IPlotPlugin : manages

package syst {
  class SystematicStrategy
  class UniverseSystematicStrategy
  class DetectorSystematicStrategy
  class WeightSystematicStrategy
}

SystematicStrategy <|-- UniverseSystematicStrategy
SystematicStrategy <|-- DetectorSystematicStrategy
SystematicStrategy <|-- WeightSystematicStrategy

note right of ISampleProcessor
  Sample processing API
end note

note right of DataProcessor
  Processes real data
end note

note right of MonteCarloProcessor
  Processes MC events
end note

note right of AnalysisRunner
  Coordinates analysis
end note

note right of IEventProcessor
  Event processing API
end note

note right of HistogramPlotterBase
  Base for plots
end note

note right of IAnalysisPlugin
  Analysis plugin API
end note

note right of AnalysisPluginManager
  Manages analysis plugins
end note

note right of IPlotPlugin
  Plot plugin API
end note

note right of PlotPluginManager
  Manages plot plugins
end note

note right of SystematicStrategy
  Base for systematics
end note

@enduml
